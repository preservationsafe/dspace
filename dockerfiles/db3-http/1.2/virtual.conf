#
# devcommons.library.arizona.edu
#
<VirtualHost *:6081>
     ServerAdmin grunlohr@u.library.arizona.edu
     DocumentRoot /data1/irdev/htdocs
     ServerName localhost
     ErrorLog /data1/uairlogs/deverror_log
     CustomLog /data1/uairlogs/devaccess_log combined
     
     <Directory "/data1/irdev/htdocs">
          #AllowOverride AuthConfig Limit
          AllowOverride All
          Order allow,deny
          Allow from all
     </Directory>
     
     # Do not allow access to .svn files or directories 
     <Directory ~ "/.*/.svn">
          Order deny,allow
          deny from all
     </Directory>
     <Files ~ "/.*/.svn/*">
          Order deny,allow
          deny from all
     </Files>
     
     # Do not show ini file contents
     <Files *.ini>
          Order allow,deny
          Deny from all
     </Files>
     
     
     # Do not show .tpl file contents
     <Files *.tpl>
          Order allow,deny
          Deny from all
     </Files>
     
# 2008.04.03 barabep
# aliases for wiki & sandbox
#     Alias /sandbox "/data1/irdev/sandbox"
#     <Directory "/data1/irdev/sandbox">
#          Options -Indexes MultiViews
#          AllowOverride All
#          Order allow,deny
#          Allow from all
#     </Directory>
#     
#     Alias /wiki "/data1/irdev/wiki"
#     <Directory "/data1/irdev/wiki">
#          Options -Indexes MultiViews
#          AllowOverride FileInfo AuthConfig Limit
#          Order allow,deny
#          Allow from all
#     </Directory>
</VirtualHost>

#
# SSL devcommons.library.arizona.edu
#
<VirtualHost *:6444>
     ServerAdmin rgrunloh@u.library.arizona.edu
     DocumentRoot /data1/irdev/htdocs
     ServerName localhost
     ErrorLog /data1/uairlogs/deverror_log
     CustomLog /data1/uairlogs/devaccess_log combined
     TransferLog /data1/uairlogs/devssl_access_log
     LogLevel warn
     SSLEngine on
     SSLProtocol all -SSLv2
     SSLCipherSuite ALL:!ADH:!EXPORT:!SSLv2:RC4+RSA:+HIGH:+MEDIUM:+LOW
     SSLCertificateFile /etc/pki/tls/certs/digitalcommons.arizona.edu.cert
     SSLCertificateChainfile /etc/pki/tls/certs/digitalcommons.arizona.edu.intermed-cert
     SSLCertificateKeyFile /etc/pki/tls/private/digitalcommons.arizona.edu.key
     
     <Files ~ "\.(cgi|shtml|phtml|php3?)$">
          SSLOptions +StdEnvVars
     </Files>
     
     <Directory "/var/www/cgi-bin">
          SSLOptions +StdEnvVars
     </Directory>
     
     SetEnvIf User-Agent ".*MSIE.*" \
          nokeepalive ssl-unclean-shutdown \
          downgrade-1.0 force-response-1.0
     
     CustomLog logs/ssl_request_log \
          "%t %h %{SSL_PROTOCOL}x %{SSL_CIPHER}x \"%r\" %b"
     
     <Directory "/data1/irdev/htdocs">
          #AllowOverride AuthConfig Limit
          AllowOverride All
          Order allow,deny
          Allow from all
     </Directory>
     
     # Do not allow access to .svn files or directories
     <Directory ~ "/.*/.svn">
          Order deny,allow
          deny from all
     </Directory>
     <Files ~ "/.*/.svn/*">
          Order deny,allow
          deny from all
     </Files>
     
     # Do not show ini file contents
     <Files *.ini>
          Order allow,deny
          Deny from all
     </Files>
     
     
     # Do not show .tpl file contents
     <Files *.tpl>
          Order allow,deny
          Deny from all
     </Files>
     
</VirtualHost>

#
# localhost
#
<VirtualHost *:6080>
     ServerAdmin grunlohr@u.library.arizona.edu
     DocumentRoot /data1/ir/htdocs
     ServerName localhost
     #ServerAlias localhost
     #ServerAlias localhost
     ErrorLog /data1/uairlogs/error_log
     CustomLog /data1/uairlogs/access_log combined

     # 2017-07-31: Librarians decided landing page redirect
     RedirectMatch "^/$" "http://uair.library.arizona.edu/"

     # 2017-09-14: Librarians journal redirect
     RewriteEngine on
     RewriteCond %{QUERY_STRING} jrm.library [NC,OR]
     RewriteCond %{QUERY_STRING} radiocarbon [NC,OR]
     RewriteCond %{QUERY_STRING} rangelands [NC]
     RewriteRule ^.*$ https://journals.uair.arizona.edu/? [R=301,L]

     # These unfortunately will filter some special collection holdings:
     #RewriteRule ^/holdings/journal(.*) https://journals.uair.arizona.edu/? [R=301,L]
     #RewriteRule ^/journal(.*) https://journals.uair.arizona.edu/? [R=301,L]

     <Directory "/data1/ir/htdocs">
# barabep 20080404 - this is interfering w/ redirect to maintenance, i think
#          AllowOverride AuthConfig Limit Indexes
          AllowOverride All
          Order allow,deny
          Allow from all
     </Directory>
     
     # Do not allow access to .svn files or directories
     <Directory ~ "/.*/.svn">
          Order deny,allow
          deny from all
     </Directory>
     
     <Files ~ "/.*/.svn/*">
          Order deny,allow
          deny from all
     </Files>
     
     # Do not show ini file contents
     <Files *.ini>
          Order allow,deny
          Deny from all
     </Files>
     
     
     # Do not show .tpl file contents
     <Files *.tpl>
          Order allow,deny
          Deny from all
     </Files>
     
</VirtualHost>
     
# 
# SSL localhost
#
<VirtualHost *:6443>
     ServerAdmin grunlohr@u.library.arizona.edu
     DocumentRoot /data1/ir/htdocs
     ServerName localhost
     #ServerAlias localhost
     #ServerAlias localhost
     ErrorLog /data1/uairlogs/error_log
     CustomLog /data1/uairlogs/access_log combined
     TransferLog /data1/uairlogs/ssl_access_log
     LogLevel warn
     SSLEngine on
     SSLProtocol all -SSLv2
     SSLCipherSuite ALL:!ADH:!EXPORT:!SSLv2:RC4+RSA:+HIGH:+MEDIUM:+LOW
     SSLCertificateFile /etc/pki/tls/certs/digitalcommons.arizona.edu.cert
     SSLCertificateChainFile /etc/pki/tls/certs/digitalcommons.arizona.edu.intermed-cert
     SSLCertificateKeyFile /etc/pki/tls/private/digitalcommons.arizona.edu.key
     
     # 2017-07-31: Librarians decided landing page redirect
     RedirectMatch "^/$" "https://uair.library.arizona.edu/"

     # 2017-09-14: Librarians journal redirect
     RewriteEngine on
     RewriteCond %{QUERY_STRING} jrm.library [NC,OR]
     RewriteCond %{QUERY_STRING} radiocarbon [NC,OR]
     RewriteCond %{QUERY_STRING} rangelands [NC]
     RewriteRule ^.*$ https://journals.uair.arizona.edu/? [R=301,L]

     <Files ~ "\.(cgi|shtml|phtml|php3?)$">
          SSLOptions +StdEnvVars
     </Files> 
     
     <Directory "/var/www/cgi-bin">
          SSLOptions +StdEnvVars
     </Directory>
     
     SetEnvIf User-Agent ".*MSIE.*" \
          nokeepalive ssl-unclean-shutdown \
          downgrade-1.0 force-response-1.0
     
     CustomLog logs/ssl_request_log \
          "%t %h %{SSL_PROTOCOL}x %{SSL_CIPHER}x \"%r\" %b"
     
     <Directory "/data1/ir/htdocs">
# barabep 20080404 - this is interfering w/ redirect to maintenance, i think
#          AllowOverride AuthConfig Limit Indexes
          AllowOverride All
          Order allow,deny
          Allow from all
     </Directory>
     
     # Do not allow access to .svn files or directories
     <Directory ~ "/.*/.svn">
          Order deny,allow
          deny from all
     </Directory>
     
     <Files ~ "/.*/.svn/*">
          Order deny,allow
          deny from all
     </Files>
     
     # Do not show ini file contents
     <Files *.ini>
          Order allow,deny
          Deny from all
     </Files>
     
     # Do not show .tpl file contents
     <Files *.tpl>
          Order allow,deny
          Deny from all
     </Files>

 </VirtualHost>

